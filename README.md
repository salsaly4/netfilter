# Antibl - Модульная система фильтрации маршрутов

Проект для проверки и обработки списков IP-адресов и подсетей с модульной архитектурой.

## Структура проекта

```
antibl/
├── main.py                 # Главный файл программы
├── requirements.txt        # Зависимости Python
├── core/                  # Основная логика
│   ├── __init__.py
│   ├── route_collector.py # Сбор маршрутов из разных источников
│   └── bird_manager.py    # Управление BIRD
├── fetchers/              # Модули для получения данных
│   ├── __init__.py
│   ├── bgp_fetcher.py     # Получение данных из BGP
│   ├── tor_fetcher.py     # Получение Tor-узлов
│   ├── github_fetcher.py  # Получение данных с GitHub
│   ├── antifilter_fetcher.py # Получение данных от antifilter
│   └── twitter_fetcher.py # Получение данных Twitter
├── network/               # Работа с сетями
│   ├── __init__.py
│   └── processor.py      # Обработка сетей и IP-адресов
└── utils/                 # Утилиты
    ├── __init__.py
    ├── cache.py          # Работа с кэшем
    └── file_utils.py     # Работа с файлами
```

## Установка и запуск

1. Создайте виртуальное окружение:
```bash
python3 -m venv venv
source venv/bin/activate  # На Linux/Mac
# или
venv\Scripts\activate     # На Windows
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

3. Запустите программу:
```bash
python main.py --help
```

## Использование

### Основные параметры

- `-a, --as-list` - файл со списком AS (по умолчанию скачивается с GitHub)
- `-o, --output` - выходной файл (по умолчанию: routes.txt)
- `-x, --exclude` - файл исключений (по умолчанию скачивается с GitHub)
- `--apply` - применить изменения в BIRD при наличии изменений
- `--summarize` - рекурсивно суммаризовать маршруты для минимизации размера

### Примеры использования

1. Базовый запуск с локальными файлами:
```bash
python main.py -a aslist.txt -o routes.txt
```

2. С суммаризацией маршрутов:
```bash
python main.py -a aslist.txt -o routes.txt --summarize
```

3. С автоматическим применением в BIRD:
```bash
python main.py -a aslist.txt -o routes.txt --apply
```

## Функциональность

### Источники данных

- **BGP.tools** - маршруты AS
- **Tor** - список Tor-узлов
- **GitHub** - ручные маршруты и исключения
- **Antifilter** - списки IP и подсетей
- **Twitter** - IP-адреса Twitter

### Обработка

- Фильтрация по списку исключений
- Суммаризация сетей для оптимизации
- Форматирование для BIRD
- Кэширование данных для офлайн работы

### Кэширование

Программа автоматически создает директорию `.cache/` и сохраняет данные от каждого источника для использования при недоступности сети.

## Преимущества модульной архитектуры

1. **Разделение ответственности** - каждый модуль отвечает за свою функциональность
2. **Легкость тестирования** - модули можно тестировать независимо
3. **Простота поддержки** - изменения в одном модуле не влияют на другие
4. **Переиспользование** - модули можно использовать в других проектах
5. **Читаемость** - код легче понимать и модифицировать

## Совместимость

- Python 3.7+
- Зависимости: requests
- Опционально: BIRD routing daemon для применения конфигурации
